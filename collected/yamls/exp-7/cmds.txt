# Get the pod name
POD_NAME=$(oc get pod -l app=vllm-benchmark -n vllm-prod -o jsonpath='{.items[0].metadata.name}')

# Create the benchmarks directory if it doesn't exist
oc exec $POD_NAME -n vllm-prod -- mkdir -p /vllm-workspace/benchmarks

# Copy the script
oc cp yamls/exp-7/run_benchmark.sh vllm-prod/$POD_NAME:/vllm-workspace/benchmarks/run_benchmark.sh

# Make it executable
oc exec $POD_NAME -n vllm-prod -- chmod +x /vllm-workspace/benchmarks/run_benchmark.sh

## A100 Experiment
# 1p1d command
BENCHMARK_SUBFOLDER="llm-d-1p1d" BENCHMARK_METRIC_PERCENTILES="95,99" BENCHMARK_REQUEST_RATE="1.8" BENCHMARK_BURSTINESS="50" ./run_benchmark.sh

# vllm 2 replicas command
BENCHMARK_SUBFOLDER="vllm-2replicas" BENCHMARK_HOST="llama3-8b" BENCHMARK_METRIC_PERCENTILES="95,99" BENCHMARK_REQUEST_RATE="1.8" BENCHMARK_BURSTINESS="50" ./run_benchmark.sh

# 2p1d command
BENCHMARK_SUBFOLDER="llm-d-2p1d" BENCHMARK_INPUT_LEN="10000" BENCHMARK_OUTPUT_LEN="100" BENCHMARK_NUM_PROMPTS="250" BENCHMARK_METRIC_PERCENTILES="95,99" BENCHMARK_REQUEST_RATE="2.5" BENCHMARK_BURSTINESS="50" ./run_benchmark.sh

# vllm 3 replicas command
BENCHMARK_SUBFOLDER="vllm-3replicas" BENCHMARK_HOST="llama3-8b" BENCHMARK_INPUT_LEN="10000" BENCHMARK_OUTPUT_LEN="100" BENCHMARK_NUM_PROMPTS="250" BENCHMARK_METRIC_PERCENTILES="95,99" BENCHMARK_REQUEST_RATE="2.5" BENCHMARK_BURSTINESS="50" ./run_benchmark.sh

## H100 Experiment
# 1p1d command
BENCHMARK_SUBFOLDER="llm-d-1p1d" BENCHMARK_INPUT_LEN="8000" BENCHMARK_OUTPUT_LEN="200" BENCHMARK_NUM_PROMPTS="200" BENCHMARK_METRIC_PERCENTILES="95,99" BENCHMARK_REQUEST_RATE="3.6" BENCHMARK_BURSTINESS="100" ./run_benchmark.sh

# vllm 2 replicas command
BENCHMARK_SUBFOLDER="vllm-2replicas" BENCHMARK_HOST="llama3-8b" BENCHMARK_INPUT_LEN="8000" BENCHMARK_OUTPUT_LEN="200" BENCHMARK_NUM_PROMPTS="200" BENCHMARK_METRIC_PERCENTILES="95,99" BENCHMARK_REQUEST_RATE="3.6" BENCHMARK_BURSTINESS="100" ./run_benchmark.sh

# 2p1d command
BENCHMARK_SUBFOLDER="llm-d-2p1d" BENCHMARK_INPUT_LEN="10000" BENCHMARK_OUTPUT_LEN="100" BENCHMARK_NUM_PROMPTS="250" BENCHMARK_METRIC_PERCENTILES="95,99" BENCHMARK_REQUEST_RATE="5.5" BENCHMARK_BURSTINESS="100" ./run_benchmark.sh

# vllm 3 replicas command
BENCHMARK_SUBFOLDER="vllm-3replicas" BENCHMARK_HOST="llama3-8b" BENCHMARK_INPUT_LEN="10000" BENCHMARK_OUTPUT_LEN="100" BENCHMARK_NUM_PROMPTS="250" BENCHMARK_METRIC_PERCENTILES="95,99" BENCHMARK_REQUEST_RATE="5.5" BENCHMARK_BURSTINESS="100" ./run_benchmark.sh
